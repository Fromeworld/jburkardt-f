14 January 2011   7:58:54.673 PM
 
R4LIB_PRB
  FORTRAN90 version
 
  Test the routines in the R4LIB library.
 
TEST001
  R4_ABS returns the absolute value of an R4.
 
   -1.252654    1.252654
    4.650541    4.650541
    3.636074    3.636074
    1.493564    1.493564
    0.322457    0.322457
   -2.471050    2.471050
   -0.939378    0.939378
   -2.120346    2.120346
   -2.649368    2.649368
    2.071726    2.071726
 
TEST002
  R4_ATAN computes the arc-tangent given Y and X;
  ATAN2 is the system version of this routine.
 
       X             Y          ATAN2(Y,X)    R4_ATAN(Y,X)
 
     1.00000       0.00000       0.00000       0.00000    
     1.00000       1.00000      0.785398      0.785398    
     0.00000       1.00000       1.57080       1.57080    
    -1.00000       1.00000       2.35619       2.35619    
    -1.00000       0.00000       3.14159       3.14159    
    -1.00000      -1.00000      -2.35619       3.92699    
     0.00000      -1.00000      -1.57080       4.71239    
     1.00000      -1.00000     -0.785398       5.49779    
 
TEST003
  R4_CAS evaluates the casine of a number.
 
        X           R8_CAS ( X )
 
     0.00000         1.00000    
    0.261799         1.22474    
    0.523599         1.36603    
    0.785398         1.41421    
     1.04720         1.36603    
     1.30900         1.22475    
     1.57080         1.00000    
     1.83260        0.707107    
     2.09439        0.366026    
     2.35619        0.357628E-06
     2.61799       -0.366025    
     2.87979       -0.707107    
     3.14159        -1.00000    
 
TEST004
  R4_CEILING rounds a value up.
 
    -1.20000            -1
    -1.00000            -1
   -0.800000             0
   -0.600000             0
   -0.400000             0
   -0.200000             0
     0.00000             0
    0.200000             1
    0.400000             1
    0.600000             1
    0.800000             1
     1.00000             1
     1.20000             2
 
TEST005
  R4_DIFF computes a difference X-Y to a given
    number of binary places.
 
  For this test, we use        3 binary places.
 
       X       Y       X-Y     R4_DIFF(X,Y)
 
    1.0000    0.0625    0.9375    0.8750
    1.0000    0.1250    0.8750    0.8750
    1.0000    0.2500    0.7500    0.7500
    1.0000    0.5000    0.5000    0.5000
    1.0000    0.8740    0.1260    0.1250
    1.0000    0.8760    0.1240    0.1250
    1.0000    0.9000    0.1000    0.1250
    1.0000    0.9500    0.0500    0.0000
    1.0000    0.9900    0.0100    0.0000
    1.0000    1.0000    0.0000    0.0000
    1.0000    1.0100   -0.0100    0.0000
    1.0000    1.0500   -0.0500    0.0000
    1.0000    1.1000   -0.1000   -0.1375
    1.0000    3.0000   -2.0000   -1.8750
    1.0000   10.0000   -9.0000   -8.7500
 
TEST006
  R4_DIGIT extracts decimal digits.
 
  Here, we get digits of    3.141592502593994    
 
   -2 -1  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
    0  0  0  3  1  4  1  5  9  2  5  0  2  5  9  3  9  9  4  1  4  0  6
 
TEST007
  R4_EPSILON produces the R4 machine precision.
 
  R = R4_EPSILON()   =   0.119209E-06
  ( 1 + R ) - 1     =    0.119209E-06
  ( 1 + (R/2) ) - 1 =     0.00000    
 
TEST008
  R4_FRACTION returns the fraction part of an R4.
 
   -1.252654    0.252654
    4.650541    0.650541
    3.636074    0.636074
    1.493564    0.493564
    0.322457    0.322457
   -2.471050    0.471050
   -0.939378    0.939378
   -2.120346    0.120346
   -2.649368    0.649368
    2.071726    0.071726
 
TEST009
  R4_HUGE returns a "huge" R4;
 
    R4_HUGE ( ) =        0.1000000015047466E+31
    HUGE ( 1.0E+00 ) =   0.3402823466385289E+39
 
TEST010
  R4_LOG_2 computes the logarithm base 2.
 
  X, R4_LOG_2
 
   0.00000     -0.340282E+39
   1.00000       0.00000    
   2.00000       1.00000    
   3.00000       1.58496    
   9.00000       3.16992    
   10.0000       3.32193    
   11.0000       3.45943    
   99.0000       6.62936    
   101.000       6.65821    
  -1.00000       0.00000    
  -2.00000       1.00000    
  -3.00000       1.58496    
  -9.00000       3.16992    
  0.500000      -1.00000    
  0.330000      -1.59946    
  0.250000      -2.00000    
  0.200000      -2.32193    
  0.100000E-01  -6.64386    
 
TEST011
  R48_LOG_B computes the logarithm base B.
 
  X, B, R4_LOG_B
 
     16.0000       2.00000       4.00000    
     16.0000       3.00000       2.52372    
     16.0000       4.00000       2.00000    
     16.0000       5.00000       1.72271    
     16.0000       6.00000       1.54741    
     16.0000       7.00000       1.42483    
     16.0000       8.00000       1.33333    
     16.0000       16.0000       1.00000    
     16.0000       32.0000      0.800000    
     16.0000       256.000      0.500000    
 
TEST012
  R4_MANT decomposes a value.
 
  Number to be decomposed:
    -314.159    
 
  R4_MANT: X =       -1 *    1.22718     * 2**       8
 
TEST013
  R4_MOD returns the remainder after division.
 
      X         Y     MOD(X,Y)    R4_MOD(X,Y)
 
   -5.6316    9.1264   -5.6316   -5.6316
    6.5902    1.2339    0.4206    0.4206
   -1.6939   -8.6776   -1.6939   -1.6939
   -4.8484   -7.8009   -4.8484   -4.8484
   -9.1234    2.6793   -1.0855   -1.0855
   -8.7655   -1.0092   -0.6917   -0.6917
   -1.9739    5.0935   -1.9739   -1.9739
    5.9457   -9.9632    5.9457    5.9457
    7.9501   -2.9850    1.9802    1.9802
   -8.1091   -9.7277   -8.1091   -8.1091
 
TEST014
  R4_MODP returns the remainder after division.
  Unlike the FORTRAN MOD, R4_MODP ( X, Y ) is positive.
 
      X       Y      MOD(X,Y)  R4_MODP(X,Y)
 
   -5.6316    9.1264   -5.6316    3.4947
    6.5902    1.2339    0.4206    0.4206
   -1.6939   -8.6776   -1.6939    6.9838
   -4.8484   -7.8009   -4.8484    2.9524
   -9.1234    2.6793   -1.0855    1.5938
   -8.7655   -1.0092   -0.6917    0.3175
   -1.9739    5.0935   -1.9739    3.1196
    5.9457   -9.9632    5.9457    5.9457
    7.9501   -2.9850    1.9802    1.9802
   -8.1091   -9.7277   -8.1091    1.6186
 
TEST015
  R4_NINT produces the nearest integer to an R4.
 
     -5.6316        -6
      9.1264         9
      6.5902         7
      1.2339         1
     -1.6939        -2
     -8.6776        -9
     -4.8484        -5
     -7.8009        -8
     -9.1234        -9
      2.6793         3
 
TEST016
  R4_NORMAL_01 generates normally distributed
    random values.
  Using initial random number seed =    123456789
 
     1.67904    
   -0.472768    
   -0.566060    
   -0.231124    
     1.21293    
    0.535037    
     1.26938    
     1.04954    
    -1.66609    
    -1.86523    
    -2.24246    
    0.735809    
    0.396752E-01
    -1.35074    
    0.673068    
    0.777484E-02
   -0.275127    
    0.374940    
     2.16400    
    0.185600    
 
TEST017
  R4_PI returns the value of PI.
 
  R4_PI =        3.141592502593994    
  4*atan(1) =    3.141592741012573    
 
TEST018
  R4_POWER computes R**P.
 
      R          P       R**P
 
     2.00000       -5  0.312500E-01
     2.00000       -4  0.625000E-01
     2.00000       -3  0.125000    
     2.00000       -2  0.250000    
     2.00000       -1  0.500000    
     2.00000        0   1.00000    
     2.00000        1   2.00000    
     2.00000        2   4.00000    
     2.00000        3   8.00000    
     2.00000        4   16.0000    
     2.00000        5   32.0000    
 
TEST019
  R4_POWER_FAST computes R**P, economizing on
    multiplications.
 
      R          P       R**P       Mults
 
     2.00000      -10  0.976563E-03    7
     2.00000       -9  0.195313E-02    7
     2.00000       -8  0.390625E-02    6
     2.00000       -7  0.781250E-02    7
     2.00000       -6  0.156250E-01    6
     2.00000       -5  0.312500E-01    6
     2.00000       -4  0.625000E-01    5
     2.00000       -3  0.125000        5
     2.00000       -2  0.250000        4
     2.00000       -1  0.500000        1
     2.00000        0   1.00000        0
     2.00000        1   2.00000        0
     2.00000        2   4.00000        3
     2.00000        3   8.00000        4
     2.00000        4   16.0000        4
     2.00000        5   32.0000        5
     2.00000        6   64.0000        5
     2.00000        7   128.000        6
     2.00000        8   256.000        5
     2.00000        9   512.000        6
     2.00000       10   1024.00        6
     2.00000       11   2048.00        7
     2.00000       12   4096.00        6
     2.00000       13   8192.00        7
     2.00000       14   16384.0        7
     2.00000       15   32768.0        8
     2.00000       16   65536.0        6
     2.00000       17   131072.        7
     2.00000       18   262144.        7
     2.00000       19   524288.        8
     2.00000       20  0.104858E+07    7
     2.00000       21  0.209715E+07    8
     2.00000       22  0.419430E+07    8
     2.00000       23  0.838861E+07    9
     2.00000       24  0.167772E+08    7
     2.00000       25  0.335544E+08    8
     2.00000       26  0.671089E+08    8
     2.00000       27  0.134218E+09    9
     2.00000       28  0.268435E+09    8
     2.00000       29  0.536871E+09    9
     2.00000       30  0.107374E+10    9
     2.00000       31  0.214748E+10   10
     2.00000       32  0.429497E+10    7
     2.00000       33  0.858993E+10    8
     2.00000       34  0.171799E+11    8
     2.00000       35  0.343597E+11    9
     2.00000       36  0.687195E+11    8
     2.00000       37  0.137439E+12    9
     2.00000       38  0.274878E+12    9
     2.00000       39  0.549756E+12   10
     2.00000       40  0.109951E+13    8
 
TEST020
  R4_ROUND2 rounds a number to a
    specified number of base 2 digits.
 
  Test effect on PI:
  X =    3.14159    
 
  NPLACE  XROUND
 
         0   0.00000    
         1   2.00000    
         2   3.00000    
         3   3.00000    
         4   3.00000    
         5   3.12500    
         6   3.12500    
         7   3.12500    
         8   3.14063    
         9   3.14063    
        10   3.14063    
        11   3.14063    
        12   3.14063    
        13   3.14111    
        14   3.14136    
        15   3.14148    
        16   3.14154    
        17   3.14157    
        18   3.14159    
        19   3.14159    
        20   3.14159    
 
TEST021
  R4_ROUNDB rounds a number to a 
    specified number of base BASE digits.
 
  Here, we will use BASE =        3
 
  Test effect on PI:
  X =    3.14159    
 
  NPLACE  XROUND
 
         0   0.00000    
         1   3.00000    
         2   3.00000    
         3   3.00000    
         4   3.11111    
         5   3.11111    
         6   3.13580    
         7   3.13992    
         8   3.14129    
         9   3.14129    
        10   3.14144    
        11   3.14154    
        12   3.14158    
        13   3.14159    
        14   3.14159    
        15   3.14159    
        16   3.14159    
        17   3.14159    
        18   3.14159    
        19   3.14159    
        20   3.14159    
 
  Try with a negative base:
 
  Input quantity is X =    121.000    
  to be rounded in base       -3
 
  Output value to        1 places is    81.0000    
 
  Output value to        2 places is    108.000    
 
  Output value to        3 places is    117.000    
 
  Output value to        4 places is    120.000    
 
  Output value to        5 places is    120.000    
 
TEST022
  R4_ROUNDX rounds a number to a 
    specified number of decimal digits.
 
  Test effect on PI:
  X =  3.141592503    
 
  NPLACE  XROUND
 
         0 0.000000000    
         1 3.000000000    
         2 3.100000143    
         3 3.139999866    
         4 3.141000032    
         5 3.141499996    
         6 3.141589880    
         7 3.141592026    
         8 3.141592503    
         9 3.141592264    
        10 3.141592264    
 
  Test effect on random values:
 
  NPLACE  X     XROUND
 
 
         0  0.2184183002       0.000000000    
         2  0.2184183002      0.2099999934    
         4  0.2184183002      0.2184000015    
         6  0.2184183002      0.2184180021    
         8  0.2184183002      0.2184183151    
        10  0.2184183002      0.2184183300    
 
         0  0.9563176036       0.000000000    
         2  0.9563176036      0.9499999881    
         4  0.9563176036      0.9562999606    
         6  0.9563176036      0.9563170075    
         8  0.9563176036      0.9563176036    
        10  0.9563176036      0.9563176036    
 
         0  0.8295092583       0.000000000    
         2  0.8295092583      0.8199999928    
         4  0.8295092583      0.8294999599    
         6  0.8295092583      0.8295090199    
         8  0.8295092583      0.8295092583    
        10  0.8295092583      0.8295092583    
 
         0  0.5616954565       0.000000000    
         2  0.5616954565      0.5600000024    
         4  0.5616954565      0.5615999699    
         6  0.5616954565      0.5616949797    
         8  0.5616954565      0.5616954565    
        10  0.5616954565      0.5616955161    
 
         0  0.4153070748       0.000000000    
         2  0.4153070748      0.4099999964    
         4  0.4153070748      0.4152999818    
         6  0.4153070748      0.4153069854    
         8  0.4153070748      0.4153070748    
        10  0.4153070748      0.4153070748    
 
TEST023
  R4_SIGN returns the sign of a number.
 
   -1.2500   -1.0000
   -0.2500   -1.0000
    0.0000    1.0000
    0.5000    1.0000
    9.0000    1.0000
 
TEST0235
  R4_SWAP swaps two reals.
 
  Before swapping:
 
    X =    1.00000    
    Y =    3.14159    
 
  After swapping:
 
    X =    3.14159    
    Y =    1.00000    
 
TEST027
  R4_UNIFORM_01 produces a sequence of random values.
 
  Using random seed    123456789
 
  SEED   R4_UNIFORM_01(SEED)
 
     469049721    0.218418    
    2053676357    0.956318    
    1781357515    0.829509    
    1206231778    0.561695    
     891865166    0.415307    
     141988902    0.661187E-01
     553144097    0.257578    
     236130416    0.109957    
      94122056    0.438290E-01
    1361431000    0.633966    
 
  Verify that the sequence can be restarted.
  Set the seed back to its original value, and see that
  we generate the same sequence.
 
  SEED   R4_UNIFORM_01(SEED)
 
     469049721    0.218418    
    2053676357    0.956318    
    1781357515    0.829509    
    1206231778    0.561695    
     891865166    0.415307    
     141988902    0.661187E-01
     553144097    0.257578    
     236130416    0.109957    
      94122056    0.438290E-01
    1361431000    0.633966    
 
TEST028
  R4_UNIFORM_01 samples a uniform random
  distribution in [0,1].
 
  Starting with seed =    123456789
 
  First few values:
 
         1    0.218418    
         2    0.956318    
         3    0.829509    
         4    0.561695    
         5    0.415307    
 
  Number of values computed was N =     1000
  Average value was   0.503040    
  Minimum value was   0.183837E-02
  Maximum value was   0.997908    
  Variance was   0.823320E-01
 
TEST137
  R4VEC_SORT_BUBBLE_A ascending sorts a R4VEC.
 
  Original array:
 
         1:  13.105098    
         2:  57.379055    
         3:  49.770554    
         4:  33.701729    
         5:  24.918425    
         6:  3.9671240    
         7:  15.454668    
         8:  6.5974078    
         9:  2.6297398    
        10:  38.037945    
 
  Ascending sorted array:
 
         1: 0.11030227    
         2: 0.81701350    
         3:  2.6297398    
         4:  3.7036338    
         5:  3.9671240    
         6:  5.6726851    
         7:  6.5974078    
         8:  13.105098    
         9:  15.454668    
        10:  21.045139    
 
R4LIB_PRB
  Normal end of execution.
 
14 January 2011   7:58:54.677 PM
